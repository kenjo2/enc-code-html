<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tools encrypt kennzy</title>
  <style>
    :root{
      --bg-dark:#050517;
      --card:rgba(8,12,32,0.78);
      --accent1:#7c3aed;
      --accent2:#06b6d4;
      --text:#e8f0ff;
      --glass:rgba(255,255,255,0.05);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg-dark);color:var(--text);overflow-x:hidden}
    /* Background */
    .bg-video{position:fixed;inset:0;z-index:0;overflow:hidden}
    .bg-video video{width:100%;height:100%;object-fit:cover;display:block}
    .bg-overlay{position:fixed;inset:0;z-index:1;background:linear-gradient(120deg,rgba(124,58,237,0.12),rgba(6,182,212,0.12));pointer-events:none}

    /* Card layout */
    .wrap{position:relative;z-index:2;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:36px}
    .card{width:1080px;max-width:100%;background:var(--card);border-radius:14px;padding:28px;border:1px solid var(--glass);box-shadow:0 12px 40px rgba(0,0,0,0.5)}
    h1{margin:0;font-size:24px;background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;color:transparent}
    .subtitle{font-size:14px;color:rgba(230,240,255,0.82);margin-top:6px}
    .accent-line{height:6px;border-radius:6px;background:linear-gradient(90deg,var(--accent2),var(--accent1));margin:12px 0}

    .grid{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:16px}
    label{display:block;font-size:13px;color:rgba(230,240,255,0.9);margin-bottom:8px}
    textarea{width:100%;height:520px;padding:14px;border-radius:10px;border:1px solid var(--glass);background:rgba(255,255,255,0.02);color:var(--text);font-family:ui-monospace,Menlo,monospace;font-size:13px;resize:vertical}

    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{cursor:pointer;border:0;padding:10px 16px;border-radius:10px;font-weight:700;transition:all .18s}
    .btn-primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;box-shadow:0 0 14px rgba(124,58,237,0.35)}
    .btn-primary:hover{transform:translateY(-3px)}
    .btn-ghost{background:transparent;border:1px solid var(--glass);color:var(--text)}
    .panel{border:1px solid var(--glass);border-radius:10px;padding:14px;background:rgba(255,255,255,0.02)}
    .muted{font-size:13px;color:rgba(230,240,255,0.65)}
    .foot{margin-top:14px;text-align:center;font-size:13px;color:rgba(230,240,255,0.75)}

    @media (max-width:1100px){
      .grid{grid-template-columns:1fr}
      textarea{height:360px}
      .card{padding:20px}
    }
  </style>
</head>
<body>

  <div class="bg-video">
    <video autoplay muted playsinline loop src="https://files.catbox.moe/gos3hh.mp4"></video>
  </div>
  <div class="bg-overlay"></div>

  <div class="wrap">
    <div class="card">
      <h1>Tools Encrypt kennzy</h1>
      <div class="subtitle">Tempel HTML di Bawah → klik <strong>Encrypt</strong>. Hasilnya bisa di copy dan di downhload dan code HTML akan tetap berjalan.</div>
      <div class="accent-line"></div>

      <div class="grid">
        <div>
          <label for="src">HTML Asli</label>
          <textarea id="src" placeholder="Tempel HTML di sini..."></textarea>

          <div class="controls">
            <button id="encryptBtn" class="btn btn-primary">Encrypt → Generate</button>
            <button id="previewBtn" class="btn btn-ghost">Preview</button>
            <button id="downloadBtn" class="btn btn-ghost">Download</button>
            <button id="copyBtn" class="btn btn-ghost">Copy</button>
          </div>

          <div style="margin-top:12px" class="muted">Note: Jika halaman asli bergantung pada relative assets (gambar/js lokal), hosting file hasil di server lebih baik.</div>
        </div>

        <div class="panel">
          <label>Succses Encrypt HTML (loader)</label>
          <textarea id="out" readonly placeholder="Hasil akan muncul di sini..."></textarea>
          <div class="muted" style="margin-top:10px">Hasil menggunakan iframe-loader (metode paling kompatibel untuk menjalankan script internal).</div>
        </div>
      </div>

      <div class="foot">Tools Ini di buat khusus untuk meng Encrypt code html dan di rangcang khusus agar code tidak dapat di copy atau di ambil oknum lain,jadi gunakan lah sebaik mungkin.</div>
    </div>
  </div>

<script>
// ---------- helpers ----------
function minifyHTML(html){
  return html.replace(/<!--([\s\S]*?)-->/g,'').replace(/>\s+</g,'><').replace(/\r\n/g,'\n').trim();
}

function u8ToB64(u8){
  let s=''; for(let i=0;i<u8.length;i++) s+=String.fromCharCode(u8[i]);
  return btoa(s);
}

// generate key+iv and encrypt text -> return base64 strings
async function encryptText(plain){
  const enc = new TextEncoder();
  const key = await crypto.subtle.generateKey({name:'AES-GCM', length:256}, true, ['encrypt','decrypt']);
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const cipherBuf = await crypto.subtle.encrypt({name:'AES-GCM', iv}, key, enc.encode(plain));
  const rawKey = await crypto.subtle.exportKey('raw', key);
  return {
    key: u8ToB64(new Uint8Array(rawKey)),
    iv: u8ToB64(iv),
    cipher: u8ToB64(new Uint8Array(cipherBuf))
  };
}

// build loader HTML that will decrypt and then create iframe.srcdoc (= best compatibility for inline scripts)
function buildLoader(payload){
  // payload.key, payload.iv, payload.cipher are base64 strings
  // we will decode + importKey + decrypt then set iframe.srcdoc = decryptedHTML
  return `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Protected</title>
<style>html,body{height:100%;margin:0;background:#050517;color:#ddd;font-family:sans-serif}#status{display:flex;align-items:center;justify-content:center;height:100vh;font-size:16px;opacity:0.9}</style>
</head>
<body>
<div id="status">Decrypting...</div>
<script>
(async()=>{
  try{
    const b64ToU8 = s => Uint8Array.from(atob(s), c=>c.charCodeAt(0));
    const keyRaw = b64ToU8("${payload.key}");
    const iv = b64ToU8("${payload.iv}");
    const ct = b64ToU8("${payload.cipher}");

    const key = await crypto.subtle.importKey("raw", keyRaw.buffer, {name:"AES-GCM"}, false, ["decrypt"]);
    const pt = await crypto.subtle.decrypt({name:"AES-GCM", iv}, key, ct.buffer);
    const html = new TextDecoder().decode(pt);

    // Create iframe and use srcdoc for best inline-script compatibility
    const iframe = document.createElement('iframe');
    iframe.style.border = '0';
    iframe.style.width = '100%';
    iframe.style.height = '100vh';
    iframe.srcdoc = html;

    // replace body content with iframe
    document.body.innerHTML = '';
    document.body.appendChild(iframe);
  }catch(e){
    const el = document.getElementById('status');
    if(el) el.innerHTML = '<div style="color:#ff8080; text-align:center;">Decryption failed.<br>' + (e && e.message ? e.message : e) + '</div>';
    console.error(e);
  }
})();
<\/script>
</body>
</html>`;
}

// ---------- UI wiring ----------
const src = document.getElementById('src');
const out = document.getElementById('out');
let lastLoader = '';

document.getElementById('encryptBtn').addEventListener('click', async () => {
  const raw = src.value || '';
  if(!raw.trim()){ alert('Tempel HTML yang ingin dienkripsi di kotak kiri.'); return; }

  out.value = 'Encrypting... (please wait)';
  try{
    const html = minifyHTML(raw);
    const payload = await encryptText(html);
    const loader = buildLoader(payload);
    lastLoader = loader;
    out.value = loader;
    alert('Selesai: hasil terenkripsi siap. Klik Download/Preview.');
  }catch(e){
    console.error(e);
    alert('Gagal saat enkripsi: ' + (e && e.message ? e.message : e));
    out.value = '';
  }
});

document.getElementById('previewBtn').addEventListener('click', () => {
  if(!lastLoader){ alert('Belum ada hasil — klik Encrypt dulu.'); return; }
  const w = window.open();
  w.document.write(lastLoader);
  w.document.close();
});

document.getElementById('copyBtn').addEventListener('click', async () => {
  if(!lastLoader){ alert('Belum ada hasil — klik Encrypt dulu.'); return; }
  try{
    await navigator.clipboard.writeText(lastLoader);
    alert('Hasil tersalin ke clipboard!');
  }catch(e){
    prompt('Copy manual — salin teks berikut:', lastLoader);
  }
});

document.getElementById('downloadBtn').addEventListener('click', () => {
  if(!lastLoader){ alert('Belum ada hasil — klik Encrypt dulu.'); return; }
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([lastLoader], {type:'text/html'}));
  a.download = 'protected-'+new Date().toISOString().replace(/[:.]/g,'-')+'.html';
  a.click();
  setTimeout(()=>URL.revokeObjectURL(a.href), 2000);
});
</script>
</body>
</html>